<!DOCTYPE html>
<html lang="ru">
<head>
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ĞĞ°Ğ¹Ğ´Ğ¸ Ğ¿Ğ°Ñ€Ñ‹</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 0;
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      font-family: 'Montserrat', sans-serif;
      display: flex; flex-direction: column; min-height: 100vh;
      align-items: center; user-select: none; overflow-x: hidden;
    }
    h1 {
      margin: 20px 0 10px;
      color: #fff;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.4);
    }
    #difficulty button, .game-btn {
      margin: 5px 10px;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 700;
      color: white;
      background: #007bff;
      box-shadow: 0 4px 10px rgba(0,123,255,0.4);
      transition: all 0.3s ease;
    }
    #difficulty button:hover, .game-btn:hover { background: #0056b3; transform: translateY(-2px); }
    #difficulty button:disabled { background: #5a96d4; cursor: default; transform: none; }

    #game-board {
      display: grid;
      gap: 12px;
      max-width: 95vw;
      justify-content: center;
      margin-top: 15px; 
      margin-bottom: 20px;
      transition: all 0.5s ease-in-out;
    }
    .card { 
      width: 90px; 
      height: 120px; 
      perspective: 1000px; 
      cursor: pointer;
      transition: opacity 0.6s ease, transform 0.5s ease-in-out, grid-area 0.5s ease-in-out;
    }
    .card.disabled {
      cursor: not-allowed;
      pointer-events: none;
    }
    .card-inner {
      position: relative; width: 100%; height: 100%;
      transition: transform 0.5s; transform-style: preserve-3d;
      border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .card.flipped .card-inner { transform: rotateY(180deg); }
    .card-front, .card-back {
      position: absolute; width: 100%; height: 100%;
      border-radius: 12px; backface-visibility: hidden;
      display: flex; justify-content: center; align-items: center; font-size: 48px;
    }
    .card-front { background: #fff; transform: rotateY(180deg); }
    .card-back { background: #1e90ff; color: #fff; box-shadow: inset 0 0 20px #1565c0; }

    #modal, #modal-settings {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 2000;
    }
    #modal.active, #modal-settings.active { opacity: 1; pointer-events: auto; }

    .modal-box {
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      padding: 20px 40px; max-width: 420px; width: 90%; text-align: center;
      border-radius: 20px; border: 3px solid white; box-shadow: 0 15px 35px rgba(0,0,0,0.4);
    }

    .modal-box h2 { 
      margin-top: 0;
      margin-bottom: 15px; 
      font-weight: 700; 
      font-size: 28px; 
      color: #fff; 
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
    }
    
    .st-row { margin: 10px 0; text-align: left; }
    .st-row label { display: block; margin-bottom: 5px; font-weight: bold; color: #fff; }
    
    .language-container {
      position: relative;
      width: 100%;
    }
    
    .language-select-wrapper {
      position: relative;
      width: 100%;
    }
    
    #lang-select {
      width: 100%; 
      padding: 15px 20px;
      font-size: 18px; 
      border-radius: 12px;
      font-family: 'Montserrat', sans-serif; 
      border: 2px solid white;
      background: rgba(255, 255, 255, 0.95);
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      color: #333;
      font-weight: 600;
    }
    
    #lang-select:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 123, 255, 0.3);
      background: white;
      border-color: #66a6ff;
    }
    
    #lang-select:focus {
      outline: none;
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 10px 30px rgba(102, 166, 255, 0.4);
      border-color: #007bff;
    }
    
    .full-width { width: 100%; margin: 10px 0 !important; }
    #play-again { background-color: #28a745; }
    #exit-win { background-color: #dc3545; }
    #sound-toggle { background-color: #17a2b8; }

    #settings-btn {
      position: fixed; top: 20px; right: 20px; 
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      border: 2px solid white;
      border-radius: 50%; 
      width: 50px; 
      height: 50px;
      font-size: 24px; 
      cursor: pointer; 
      display: flex;
      align-items: center; 
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0,123,255,0.3); 
      z-index: 1500;
      color: white;
      transition: all 0.3s ease;
    }

    #settings-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0,123,255,0.4);
    }
    
    #message {
      position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
      background: rgba(50, 50, 50, 0.9); color: #fff; padding: 12px 24px;
      border-radius: 12px; font-size: 22px; font-weight: bold;
      opacity: 0; transition: opacity 0.5s ease; z-index: 3000;
      pointer-events: none; border: 2px solid #fff;
    }

    .volume-control {
      margin: 15px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .volume-slider-container {
      display: flex;
      align-items: center;
      margin: 12px 0;
    }

    .volume-slider {
      flex: 1;
      -webkit-appearance: none;
      appearance: none;
      height: 10px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 5px;
      outline: none;
      cursor: pointer;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
      transition: all 0.3s ease;
    }

    .volume-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(0, 123, 255, 0.8);
    }

    .volume-slider::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
    }

    .volume-value {
      margin-left: 15px;
      min-width: 40px;
      text-align: center;
      font-weight: bold;
      color: white;
      font-size: 16px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      background: rgba(255, 255, 255, 0.2);
      padding: 5px 10px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .volume-label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      color: white;
      font-size: 16px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-box {
      animation: fadeInUp 0.4s ease-out;
    }

    .music-disclaimer {
      margin: 15px 0;
      padding: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      text-align: center;
      color: white;
      font-size: 12px;
      line-height: 1.4;
    }

    .music-disclaimer h4 {
      margin: 0 0 6px 0;
      font-size: 14px;
      color: #e6f7ff;
      font-weight: 700;
    }

    .music-disclaimer p {
      margin: 0;
      opacity: 0.9;
    }

    .music-note {
      font-size: 20px;
      margin-right: 8px;
      vertical-align: middle;
    }
  </style>
</head>
<body>

<h1 id="main-title">Find Pairs</h1>

<div id="difficulty">
  <button data-cards="10" id="btn-easy">Easy</button>
  <button data-cards="20" id="btn-norm">Normal</button>
  <button data-cards="30" id="btn-hard">Hard</button>
  <button data-cards="50" id="btn-extr">Extreme</button>
</div>

<button id="settings-btn">âš™ï¸</button>

<div id="game-board"></div>

<div id="message"></div>

<div id="modal">
  <div class="modal-box">
    <h2 id="win-text">Well done!</h2>
    <button id="play-again" class="game-btn full-width">Play Again</button>
    <button id="exit-win" class="game-btn full-width">Exit</button>
  </div>
</div>

<div id="modal-settings">
  <div class="modal-box">
    <h2 id="st-header">Settings</h2>
    
    <div class="st-row">
      <label id="st-lang-label">Language:</label>
      <div class="language-container">
        <div class="language-select-wrapper">
          <select id="lang-select">
            <option value="ru" class="language-option">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            <option value="en" selected class="language-option">English</option>
            <option value="ua" class="language-option">Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°</option>
            <option value="by" class="language-option">Ğ‘ĞµĞ»Ğ°Ñ€ÑƒÑĞºĞ°Ñ</option>
            <option value="it" class="language-option">Italiano</option>
            <option value="es" class="language-option">EspaÃ±ol</option>
            <option value="ar" class="language-option">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="zh" class="language-option">ä¸­æ–‡</option>
            <option value="jp" class="language-option">æ—¥æœ¬èª</option>
            <option value="am" class="language-option">Õ€Õ¡ÕµÕ¥Ö€Õ¥Õ¶</option>
          </select>
        </div>
      </div>
    </div>
    
    <div class="music-disclaimer">
      <h4><span class="music-note">ğŸµ</span><span id="music-title">ĞœÑƒĞ·Ñ‹ĞºĞ° Ğ² Ğ¸Ğ³Ñ€Ğµ</span></h4>
      <p id="music-text">Ğ¤Ğ¾Ğ½Ğ¾Ğ²Ğ°Ñ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°: "Fluffing a Duck" by Kevin MacLeod<br>Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ: Creative Commons Attribution 4.0</p>
    </div>
    
    <div class="volume-control">
      <label class="volume-label" id="music-volume-label">Music Volume:</label>
      <div class="volume-slider-container">
        <input type="range" min="0" max="100" value="50" class="volume-slider" id="music-volume">
        <div class="volume-value" id="music-volume-value">50%</div>
      </div>
      
      <label class="volume-label" id="effects-volume-label">Effects Volume:</label>
      <div class="volume-slider-container">
        <input type="range" min="0" max="100" value="70" class="volume-slider" id="effects-volume">
        <div class="volume-value" id="effects-volume-value">70%</div>
      </div>
    </div>
    
    <button id="sound-toggle" class="game-btn full-width">Music: ON</button>
    <button id="close-settings" class="game-btn full-width">OK</button>
  </div>
</div>

<script>
  const cardSymbols = ['ğŸ','ğŸŒ','ğŸ‡','ğŸ“','ğŸ','ğŸ¥','ğŸ’','ğŸ¥¥','ğŸ‰','ğŸ‘','ğŸ¥­','ğŸ','ğŸ‹','ğŸŠ','ğŸˆ','ğŸ…','ğŸ†','ğŸ¥•','ğŸŒ½','ğŸ¥”','ğŸ¥’','ğŸ¥¬','ğŸŒ¶ï¸','ğŸ§„','ğŸ§…','ğŸ„','ğŸ¥œ','ğŸŒ°','ğŸ¥‘','ğŸ','ğŸ§€','ğŸ—','ğŸ–','ğŸ¥©','ğŸ¤','ğŸ™','ğŸš','ğŸ¥¨','ğŸ¥¯','ğŸ”','ğŸŸ','ğŸŒ­','ğŸ•','ğŸ¥ª','ğŸŒ®','ğŸŒ¯','ğŸ¥—','ğŸ¥«','ğŸ¦','ğŸ°'];
  
  const translations = {
    ru: { 
      title: "ĞĞ°Ğ¹Ğ´Ğ¸ Ğ¿Ğ°Ñ€Ñ‹", 
      easy: "Ğ›ĞµĞ³ĞºĞ¾", 
      norm: "ĞĞ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾", 
      hard: "Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾", 
      extr: "Ğ­ĞºÑÑ‚Ñ€Ğ¸Ğ¼", 
      win: "ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†, Ñ‚Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»!", 
      again: "Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ ĞµÑ‰Ñ‘ Ñ€Ğ°Ğ·", 
      exit: "Ğ’Ñ‹Ğ¹Ñ‚Ğ¸", 
      st: "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸", 
      lang: "Ğ¯Ğ·Ñ‹Ğº:", 
      sndOn: "ĞœÑƒĞ·Ñ‹ĞºĞ°: Ğ’ĞšĞ›", 
      sndOff: "ĞœÑƒĞ·Ñ‹ĞºĞ°: Ğ’Ğ«ĞšĞ›", 
      match: "ĞŸĞ°Ñ€Ğ° Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!", 
      ok: "ĞĞš",
      musicVol: "Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸:",
      effectsVol: "Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ²:",
      musicTitle: "ĞœÑƒĞ·Ñ‹ĞºĞ° Ğ² Ğ¸Ğ³Ñ€Ğµ",
      musicText: "Ğ¤Ğ¾Ğ½Ğ¾Ğ²Ğ°Ñ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°: 'Fluffing a Duck' Ğ¾Ñ‚ Kevin MacLeod<br>Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ: Creative Commons Attribution 4.0"
    },
    en: { 
      title: "Find Pairs", 
      easy: "Easy", 
      norm: "Normal", 
      hard: "Hard", 
      extr: "Extreme", 
      win: "Well done, you won!", 
      again: "Play Again", 
      exit: "Exit", 
      st: "Settings", 
      lang: "Language:", 
      sndOn: "Music: ON", 
      sndOff: "Music: OFF", 
      match: "Match found!", 
      ok: "OK",
      musicVol: "Music Volume:",
      effectsVol: "Effects Volume:",
      musicTitle: "Game Music",
      musicText: "Background music: 'Fluffing a Duck' by Kevin MacLeod<br>License: Creative Commons Attribution 4.0"
    },
    ua: { 
      title: "Ğ—Ğ½Ğ°Ğ¹Ğ´Ğ¸ Ğ¿Ğ°Ñ€Ğ¸", 
      easy: "Ğ›ĞµĞ³ĞºĞ¾", 
      norm: "ĞĞ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾", 
      hard: "Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ğ¾", 
      extr: "Ğ•ĞºÑÑ‚Ñ€Ğ¸Ğ¼", 
      win: "ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†ÑŒ, Ñ‚Ğ¸ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²!", 
      again: "Ğ“Ñ€Ğ°Ñ‚Ğ¸ Ñ‰Ğµ Ñ€Ğ°Ğ·", 
      exit: "Ğ’Ğ¸Ğ¹Ñ‚Ğ¸", 
      st: "ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ", 
      lang: "ĞœĞ¾Ğ²Ğ°:", 
      sndOn: "ĞœÑƒĞ·Ğ¸ĞºĞ°: Ğ’ĞšĞ›", 
      sndOff: "ĞœÑƒĞ·Ğ¸ĞºĞ°: Ğ’Ğ˜ĞœĞš", 
      match: "ĞŸĞ°Ñ€Ñƒ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾!", 
      ok: "Ğ”Ğ¾Ğ±Ñ€Ğµ",
      musicVol: "Ğ“ÑƒÑ‡Ğ½Ñ–ÑÑ‚ÑŒ Ğ¼ÑƒĞ·Ğ¸ĞºĞ¸:",
      effectsVol: "Ğ“ÑƒÑ‡Ğ½Ñ–ÑÑ‚ÑŒ ĞµÑ„ĞµĞºÑ‚Ñ–Ğ²:",
      musicTitle: "ĞœÑƒĞ·Ğ¸ĞºĞ° Ğ² Ğ³Ñ€Ñ–",
      musicText: "Ğ¤Ğ¾Ğ½Ğ¾Ğ²Ğ° Ğ¼ÑƒĞ·Ğ¸ĞºĞ°: 'Fluffing a Duck' Ğ²Ñ–Ğ´ Kevin MacLeod<br>Ğ›Ñ–Ñ†ĞµĞ½Ğ·Ñ–Ñ: Creative Commons Attribution 4.0"
    },
    by: { 
      title: "Ğ—Ğ½Ğ°Ğ¹Ğ´Ğ·Ñ– Ğ¿Ğ°Ñ€Ñ‹", 
      easy: "Ğ›Ñ‘Ğ³ĞºĞ°", 
      norm: "ĞĞ°Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°", 
      hard: "Ğ¡ĞºĞ»Ğ°Ğ´Ğ°Ğ½Ğ°", 
      extr: "Ğ­ĞºÑÑ‚Ñ€Ñ‹Ğ¼", 
      win: "ĞœĞ°Ğ»Ğ°Ğ´Ğ·ĞµÑ†, Ñ‚Ñ‹ Ğ²Ñ‹Ğ¹Ğ³Ñ€Ğ°Ñ!", 
      again: "Ğ“ÑƒĞ»ÑÑ†ÑŒ ÑÑˆÑ‡Ñ Ñ€Ğ°Ğ·", 
      exit: "Ğ’Ñ‹Ğ¹ÑÑ†Ñ–", 
      st: "ĞĞ°Ğ»Ğ°Ğ´Ñ‹", 
      lang: "ĞœĞ¾Ğ²Ğ°:", 
      sndOn: "ĞœÑƒĞ·Ñ‹ĞºĞ°: Ğ’ĞšĞ›", 
      sndOff: "ĞœÑƒĞ·Ñ‹ĞºĞ°: Ğ’Ğ«ĞšĞ›", 
      match: "ĞŸĞ°Ñ€Ğ° Ğ·Ğ½Ğ¾Ğ¹Ğ´Ğ·ĞµĞ½Ğ°!", 
      ok: "ĞĞš",
      musicVol: "Ğ“ÑƒÑ‡Ğ½Ğ°ÑÑ†ÑŒ Ğ¼ÑƒĞ·Ñ‹ĞºÑ–:",
      effectsVol: "Ğ“ÑƒÑ‡Ğ½Ğ°ÑÑ†ÑŒ ÑÑ„ĞµĞºÑ‚Ğ°Ñ:",
      musicTitle: "ĞœÑƒĞ·Ñ‹ĞºĞ° Ñ Ğ³ÑƒĞ»ÑŒĞ½Ñ–",
      musicText: "Ğ¤Ğ¾Ğ½Ğ°Ğ²Ğ°Ñ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°: 'Fluffing a Duck' Ğ°Ğ´ Kevin MacLeod<br>Ğ›Ñ–Ñ†ÑĞ½Ğ·Ñ–Ñ: Creative Commons Attribution 4.0"
    },
    it: { 
      title: "Trova le coppie", 
      easy: "Facile", 
      norm: "Normale", 
      hard: "Difficile", 
      extr: "Estremo", 
      win: "Bravo, hai vinto!", 
      again: "Gioca ancora", 
      exit: "Esci", 
      st: "Impostazioni", 
      lang: "Lingua:", 
      sndOn: "Musica: ON", 
      sndOff: "Musica: OFF", 
      match: "Coppia trovata!", 
      ok: "OK",
      musicVol: "Volume Musica:",
      effectsVol: "Volume Effetti:",
      musicTitle: "Musica nel gioco",
      musicText: "Musica di sottofondo: 'Fluffing a Duck' di Kevin MacLeod<br>Licenza: Creative Commons Attribution 4.0"
    },
    es: { 
      title: "Encontrar pares", 
      easy: "FÃ¡cil", 
      norm: "Normal", 
      hard: "DifÃ­cil", 
      extr: "Extremo", 
      win: "Â¡Bien hecho, ganaste!", 
      again: "Jugar de nuevo", 
      exit: "Salir", 
      st: "Ajustes", 
      lang: "Idioma:", 
      sndOn: "MÃºsica: ON", 
      sndOff: "MÃºsica: OFF", 
      match: "Â¡Pareja encontrada!", 
      ok: "Aceptar",
      musicVol: "Volumen MÃºsica:",
      effectsVol: "Volumen Efectos:",
      musicTitle: "MÃºsica del juego",
      musicText: "MÃºsica de fondo: 'Fluffing a Duck' por Kevin MacLeod<br>Licencia: Creative Commons Attribution 4.0"
    },
    ar: { 
      title: "Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø²ÙˆØ§Ø¬", 
      easy: "Ø³Ù‡Ù„", 
      norm: "Ø¹Ø§Ø¯ÙŠ", 
      hard: "ØµØ¹Ø¨", 
      extr: "Ø£Ù‚ØµÙ‰", 
      win: "Ø£Ø­Ø³Ù†ØªØŒ Ù„Ù‚Ø¯ ÙØ²Øª!", 
      again: "Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰", 
      exit: "Ø®Ø±ÙˆØ¬", 
      st: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", 
      lang: "Ø§Ù„Ù„ØºØ©:", 
      sndOn: "Ù…ÙˆØ³ÙŠÙ‚Ù‰: ØªÙØ¹ÙŠÙ„", 
      sndOff: "Ù…ÙˆØ³ÙŠÙ‚Ù‰: ØªØ¹Ø·ÙŠÙ„", 
      match: "ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²ÙˆØ¬!", 
      ok: "Ù…ÙˆØ§ÙÙ‚",
      musicVol: "Ù…Ø³ØªÙˆÙ‰ ØµÙˆØª Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰:",
      effectsVol: "Ù…Ø³ØªÙˆÙ‰ ØµÙˆØª Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª:",
      musicTitle: "Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©",
      musicText: "Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ©: 'Fluffing a Duck' Ø¨ÙˆØ§Ø³Ø·Ø© Kevin MacLeod<br>Ø§Ù„ØªØ±Ø®ÙŠØµ: Creative Commons Attribution 4.0"
    },
    zh: { 
      title: "é…å¯¹æ¸¸æˆ", 
      easy: "ç®€å•", 
      norm: "æ™®é€š", 
      hard: "å›°éš¾", 
      extr: "æé™", 
      win: "å¤ªæ£’äº†, ä½ èµ¢äº†!", 
      again: "å†ç©ä¸€æ¬¡", 
      exit: "é€€å‡º", 
      st: "è®¾ç½®", 
      lang: "è¯­è¨€:", 
      sndOn: "éŸ³ä¹: å¼€å¯", 
      sndOff: "éŸ³ä¹: å…³é—­", 
      match: "é…å¯¹æˆåŠŸ!", 
      ok: "ç¡®å®š",
      musicVol: "éŸ³ä¹éŸ³é‡:",
      effectsVol: "æ•ˆæœéŸ³é‡:",
      musicTitle: "æ¸¸æˆéŸ³ä¹",
      musicText: "èƒŒæ™¯éŸ³ä¹: Kevin MacLeod çš„ 'Fluffing a Duck'<br>è®¸å¯åè®®: Creative Commons Attribution 4.0"
    },
    jp: { 
      title: "ãƒšã‚¢æ¢ã—", 
      easy: "ç°¡å˜", 
      norm: "æ™®é€š", 
      hard: "é›£ã—ã„", 
      extr: "ã‚¨ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ ", 
      win: "ã‚„ã£ãŸã­, ã‚ãªãŸã®å‹ã¡!", 
      again: "ã‚‚ã†ä¸€åº¦éŠã¶", 
      exit: "çµ‚äº†", 
      st: "è¨­å®š", 
      lang: "è¨€èª:", 
      sndOn: "éŸ³æ¥½: ã‚ªãƒ³", 
      sndOff: "éŸ³ä¹: ã‚ªãƒ•", 
      match: "ãƒšã‚¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ!", 
      ok: "ç¢ºå®š",
      musicVol: "éŸ³æ¥½ã®éŸ³é‡:",
      effectsVol: "åŠ¹æœéŸ³ã®éŸ³é‡:",
      musicTitle: "ã‚²ãƒ¼ãƒ éŸ³æ¥½",
      musicText: "èƒŒæ™¯éŸ³æ¥½: Kevin MacLeod ã® 'Fluffing a Duck'<br>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹: Creative Commons Attribution 4.0"
    },
    am: { 
      title: "Ô³Õ¿Õ¶Õ¥Õ¬ Õ¦Õ¸Ö‚ÕµÕ£Õ¥Ö€Õ¨", 
      easy: "Õ€Õ¥Õ·Õ¿", 
      norm: "Õ†Õ¸Ö€Õ´Õ¡Õ¬", 
      hard: "Ô´ÕªÕ¾Õ¡Ö€", 
      extr: "Ô·Ö„Õ½Õ¿Ö€Õ«Õ´", 
      win: "Ô±ÕºÖ€Õ¥Õ½, Õ¤Õ¸Ö‚ Õ°Õ¡Õ²Õ©Õ¥ÖÕ«Ö€:", 
      again: "Ô½Õ¡Õ²Õ¡Õ¬ Õ¶Õ¸Ö€Õ«Ö", 
      exit: "ÔµÕ¬Ö„", 
      st: "Ô¿Õ¡Ö€Õ£Õ¡Õ¾Õ¸Ö€Õ¸Ö‚Õ´Õ¶Õ¥Ö€", 
      lang: "Ô¼Õ¥Õ¦Õ¸Ö‚:", 
      sndOn: "ÔµÖ€Õ¡ÕªÕ·Õ¿Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶. Õ„Ô»Ô±Õ‘ÕÔ±Ô¾", 
      sndOff: "ÔµÖ€Õ¡ÕªÕ·Õ¿Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶. Ô±Õ†Õ‹Ô±ÕÕÔ±Ô¾", 
      match: "Ô¶Õ¸Ö‚ÕµÕ£Õ¨ Õ£Õ¿Õ¶Õ¾Õ¡Õ® Õ§:", 
      ok: "Ô¼Õ¡Õ¾",
      musicVol: "ÔµÖ€Õ¡ÕªÕ·Õ¿Õ¸Ö‚Õ©ÕµÕ¡Õ¶ Õ¢Õ¡Ö€Õ±Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶:",
      effectsVol: "Õ§Ö†Õ¥Õ¯Õ¿Õ¶Õ¥Ö€Õ« Õ¢Õ¡Ö€Õ±Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶:",
      musicTitle: "Ô½Õ¡Õ²Õ« Õ¥Ö€Õ¡ÕªÕ·Õ¿Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
      musicText: "ÔµÕ¿Õ¶Õ¡ÕºÕ¬Õ¡Õ¶Õ¡ÕµÕ«Õ¶ Õ¥Ö€Õ¡ÕªÕ·Õ¿Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶: 'Fluffing a Duck' Kevin MacLeod-Õ«Ö<br>Ô¼Õ«ÖÕ¥Õ¶Õ¦Õ«Õ¡: Creative Commons Attribution 4.0"
    }
  };

  let firstCard = null, secondCard = null, lockBoard = false;
  let matchedPairs = 0, totalPairs = 0, currentCols = 0;
  let currentLang = 'en', musicEnabled = false;
  let musicVolume = 0.5;
  let effectsVolume = 0.7;

  const gameBoard = document.getElementById('game-board');
  const messageBox = document.getElementById('message');
  const modal = document.getElementById('modal');
  const modalSt = document.getElementById('modal-settings');
  const soundToggle = document.getElementById('sound-toggle');
  const langSelect = document.getElementById('lang-select');
  
  const soundFlip = new Audio('dostavanie_karti.mp3');
  const soundTap = new Audio('tap.mp3');
  const soundMatch = new Audio('pravilna_para.mp3');
  const soundWin = new Audio('pobeda.mp3');
  const soundLose = new Audio('proigral.mp3');
  
  const bgMusic = new Audio('music.mp3');
  bgMusic.loop = true;
  bgMusic.volume = musicVolume;

  function updateVolumes() {
    bgMusic.volume = musicVolume;
    soundFlip.volume = effectsVolume;
    soundTap.volume = effectsVolume;
    soundMatch.volume = effectsVolume;
    soundWin.volume = effectsVolume;
    soundLose.volume = effectsVolume;
  }

  function playEffect(audio) {
    audio.currentTime = 0;
    audio.volume = effectsVolume;
    audio.play().catch(()=>{});
  }

  function toggleBgMusic() {
    if (musicEnabled) {
      bgMusic.play().catch(e => {});
    } else {
      bgMusic.pause();
    }
  }

  function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  function shuffleRemaining() {
    const cards = Array.from(document.querySelectorAll('.card')).filter(c => c.style.opacity !== '0');
    if (cards.length === 0) return;

    const shuffled = shuffle([...cards]);
    
    shuffled.forEach((card, index) => {
      const row = Math.floor(index / currentCols) + 1;
      const col = (index % currentCols) + 1;
      card.style.gridArea = `${row} / ${col} / ${row + 1} / ${col + 1}`;
      card.style.transform = "scale(1.05)";
      setTimeout(() => card.style.transform = "scale(1)", 300);
    });
  }

  function updateUI() {
    const t = translations[currentLang] || translations.en;
    
    document.getElementById('main-title').textContent = t.title;
    document.getElementById('btn-easy').textContent = t.easy;
    document.getElementById('btn-norm').textContent = t.norm;
    document.getElementById('btn-hard').textContent = t.hard;
    document.getElementById('btn-extr').textContent = t.extr;
    document.getElementById('win-text').textContent = t.win;
    document.getElementById('play-again').textContent = t.again;
    document.getElementById('exit-win').textContent = t.exit;
    
    document.getElementById('st-header').textContent = t.st;
    document.getElementById('st-lang-label').textContent = t.lang;
    document.getElementById('close-settings').textContent = t.ok;
    document.getElementById('music-volume-label').textContent = t.musicVol;
    document.getElementById('effects-volume-label').textContent = t.effectsVol;
    document.getElementById('music-title').textContent = t.musicTitle;
    document.getElementById('music-text').innerHTML = t.musicText;
    
    soundToggle.textContent = musicEnabled ? t.sndOn : t.sndOff;
    
    document.getElementById('music-volume-value').textContent = Math.round(musicVolume * 100) + '%';
    document.getElementById('effects-volume-value').textContent = Math.round(effectsVolume * 100) + '%';
  }

  function showMatchMessage() {
    const t = translations[currentLang] || translations.en;
    messageBox.textContent = t.match;
    messageBox.style.opacity = '1';
    setTimeout(() => { messageBox.style.opacity = '0'; }, 1200);
  }

  function setupBoard(cardsCount) {
    gameBoard.innerHTML = '';
    matchedPairs = 0;
    totalPairs = cardsCount / 2;
    const symbols = shuffle([...cardSymbols]).slice(0, totalPairs);
    const cardSet = shuffle([...symbols, ...symbols]);
    currentCols = Math.min(10, Math.ceil(Math.sqrt(cardSet.length)));
    gameBoard.style.gridTemplateColumns = `repeat(${currentCols}, 90px)`;
    
    cardSet.forEach((symbol, index) => {
      const card = document.createElement('div');
      card.className = 'card';
      const row = Math.floor(index / currentCols) + 1;
      const col = (index % currentCols) + 1;
      card.style.gridArea = `${row} / ${col} / ${row + 1} / ${col + 1}`;
      card.innerHTML = `<div class="card-inner"><div class="card-front">${symbol}</div><div class="card-back">â“</div></div>`;
      card.dataset.symbol = symbol;
      card.onclick = () => onCardClick(card);
      gameBoard.appendChild(card);
    });
    lockBoard = false; firstCard = null;
  }

  function onCardClick(card) {
    if (lockBoard || card === firstCard || card.classList.contains('flipped') || card.classList.contains('disabled')) return;
    playEffect(soundFlip);
    card.classList.add('flipped');
    if (!firstCard) { firstCard = card; return; }
    secondCard = card; lockBoard = true;

    if (firstCard.dataset.symbol === secondCard.dataset.symbol) {
      playEffect(soundMatch);
      showMatchMessage();
      const c1 = firstCard; const c2 = secondCard;
      
      document.querySelectorAll('.card').forEach(c => {
        c.classList.add('disabled');
      });
      
      setTimeout(() => {
        c1.style.transition = 'opacity 1s ease-in-out';
        c2.style.transition = 'opacity 1s ease-in-out';
        c1.style.opacity = '0';
        c2.style.opacity = '0';
        
        setTimeout(() => {
          c1.style.pointerEvents = 'none';
          c2.style.pointerEvents = 'none';
          
          document.querySelectorAll('.card:not([style*="opacity: 0"])').forEach(c => {
            c.classList.remove('disabled');
          });
          
          shuffleRemaining();
        }, 1000);
      }, 500);

      matchedPairs++;
      if (matchedPairs === totalPairs) {
        setTimeout(() => { playEffect(soundWin); modal.classList.add('active'); }, 1500);
      }
      lockBoard = false; firstCard = null;
    } else {
      playEffect(soundLose);
      setTimeout(() => {
        firstCard.classList.remove('flipped');
        secondCard.classList.remove('flipped');
        firstCard = null; lockBoard = false;
      }, 1000);
    }
  }

  document.querySelectorAll('#difficulty button').forEach(btn => {
    btn.onclick = () => {
      playEffect(soundTap);
      setupBoard(parseInt(btn.dataset.cards));
      document.querySelectorAll('#difficulty button').forEach(b => b.disabled = false);
      btn.disabled = true;
    };
  });

  document.getElementById('settings-btn').onclick = () => { 
    playEffect(soundTap); 
    modalSt.classList.add('active'); 
    document.getElementById('music-volume').value = musicVolume * 100;
    document.getElementById('effects-volume').value = effectsVolume * 100;
  };
  
  document.getElementById('close-settings').onclick = () => { 
    playEffect(soundTap); 
    modalSt.classList.remove('active'); 
  };
  
  soundToggle.onclick = () => {
    musicEnabled = !musicEnabled;
    playEffect(soundTap);
    updateUI();
    toggleBgMusic();
  };

  langSelect.addEventListener('change', (e) => {
    currentLang = e.target.value;
    updateUI();
  });

  document.getElementById('music-volume').addEventListener('input', (e) => {
    musicVolume = parseInt(e.target.value) / 100;
    updateVolumes();
    document.getElementById('music-volume-value').textContent = e.target.value + '%';
  });

document.querySelector('.language-select-wrapper').addEventListener('click', () => {
  playEffect(soundTap);
});

  document.getElementById('effects-volume').addEventListener('input', (e) => {
    effectsVolume = parseInt(e.target.value) / 100;
    updateVolumes();
    document.getElementById('effects-volume-value').textContent = e.target.value + '%';
  });

  document.getElementById('music-volume').addEventListener('mousedown', () => {
    playEffect(soundTap);
  });

  document.getElementById('effects-volume').addEventListener('mousedown', () => {
    playEffect(soundTap);
  });

  document.getElementById('play-again').onclick = () => {
    playEffect(soundTap);
    modal.classList.remove('active');
    const activeDifficulty = Array.from(document.querySelectorAll('#difficulty button')).find(b => b.disabled);
    setupBoard(activeDifficulty ? parseInt(activeDifficulty.dataset.cards) : 10);
  };

  document.getElementById('exit-win').onclick = () => {
    playEffect(soundTap);
    setTimeout(() => { window.close(); }, 150); 
  };

  setupBoard(10);
  updateUI();
  updateVolumes();
</script>
</body>
</html>